###############################################
# General settings
###############################################
#export EDITOR=nano
export LD_LIBRARY_PATH="/usr/X11R6/lib:"$LD_LIBRARY_PATH

###############################################
# Perforce
###############################################
export P4CLIENT=$USER
export P4PORT=perforce.athenahealth.com:1666
export P4_HOME=/home/$USER/p4

# If using perforce in windows, uncomment this line
# export P4WINROOT=z:\\p4

# If not using perforce in windows, uncomment these lines
export P4LOCALROOT=$P4_HOME
export P4WINROOT=$P4_HOME

###############################################
# Athena-specific config
###############################################
export EMAILINTERCEPTADDRESS="$USER@athenahealth.com"
export BARCODEWEBSERVICELOC=http://ars-anetsrv1.corp.athenahealth.com/perl/barcode/ws.pl
export MEMCACHEDPOOL=DEV
export FILEROOT=/home/$USER/fileroot
export REDIRECT_PERL_FILEROOT=1
export WIKI_HOME=/home/$USER/wiki
export PATH="$HOME/bin:$PATH:$P4_HOME/intranet/bin:$P4_HOME/techops/coredev/:$P4_HOME/techops/coredev/bin"

# We should not have two of these, but we do.
# Also they shouldn't need to be Y, but they may.
export ISDEVSERVER='Y'
export ISDEVELOPMENT='Y'

## JUSTIN-SPECIFIC

export JIRAPROJECT='EIP'
export VERIFY_CODE_OPTIONS="--strict"
export PERL5LIB="$PERL5LIB:$HOME/lib/perl5"

# Override the default ls colors
export LS_COLORS="no=00:fi=00:di=01;34:ln=00;36:pi=40;32:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31:ex=00;32:"

alias pc="perl -MAthena::Lib -c"
alias myglimpse="aglimpse --build prod --nowiki"

## see the OO inheritance of Athena-style objects
perl_oo_structure() {
    find . -name "*.pm" -print \
    | grep -v _Test.pm \
    | xargs perl -0777 -nE'
        if(($p) = /^package (.*);/) {
         say $p;
         if (($e) = /EXTENDS => '\''(.*)'\''/) {
          say "\textends $e"
         }
        }'
}

function remove_files_from_out {
	#perl -i -ne'print unless /\.(js|rb|whiskers|php|cfm|html|less|css|md|py|ts|pod|xml|cpp|h|rule|txt|map|json|jsx): /' $1
	perl -i -ne'print if /\.(pl|pm|t|esp): /i' $1
}

function kill_httpd {
	kill    $1; sleep 5;
	kill -2 $1; sleep 5;
	kill -9 $1
}

function restart_httpd {
	unharr jmcguirefeature
	for pid in $(myps | perl -ane'print $F[1] . " " if $F[3] eq "httpd"')
	do
		kill    $pid; sleep 3;
		kill -2 $pid; sleep 3;
		kill -9 $pid
	done
	harr --optimize jmcguirefeature
}

source ~/.bashrc
source ~/.bashmarks.sh
branch EIP/betteraggregate
